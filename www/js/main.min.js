function num2str(e,t){var n=e%10;return(e=Math.abs(e)%100)>10&&e<20?t[2]:n>1&&n<5?t[1]:1==n?t[0]:t[2]}function active_buttons(e){0!=e&&(e=!0),localStorage.getItem("session_key")&&e?($("body > header").show(),$("body > footer").show()):($("body > header").hide(),$("body > footer").hide())}function scroll_to(e,t,n){scroll_val=e?e.offset().top:0,scroll_val=t||scroll_val,n=null!=n?n:500,$(document).find("html,body").animate({scrollTop:scroll_val},n)}function page_prev(e,t){e?(arrInner=e.split("/"),arrInner.length>2?pages_history.length>1?(pages_history.push(e),pages_history.length>=pages_history_length&&(pages_history=pages_history.slice(-1*pages_history_length),$(document).find("#main_menu_back").addClass("_active_"))):1==pages_history.length&&(pages_history.push(e),$(document).find("#main_menu_back").addClass("_active_")):(pages_history=[],$(document).find("#main_menu_back").removeClass("_active_")),0==pages_history.length&&e.length>0&&(pages_history.push(e),$(document).find("#main_menu_back").removeClass("_active_"))):(pages_history=[],$(document).find("#main_menu_back").removeClass("_active_"))}function template_parse(e,t){var e=$("<div/>").html(e),n=$(e).find("header").length>0?$(e).find("header").html():"",a=$(e).find("main").length>0?$(e).find("main").html():"",o=$(e).find("main").length>0?$(e).find("main").attr("class"):"",s=$(e).find("footer").length>0?$(e).find("footer").html():"";$(document).find("body header .block_header_items").html(n),$(document).find("body main").html(a).attr("class",""),$(document).find("body main").addClass(o),$(document).find("body footer").html(s),content_parse(e,t),$(document).find("#main_menu li."+o).addClass("_active_").siblings().removeClass("_active_")}function content_parse(e,t){for(var n=t.split("/"),a=n[n.length-1],o=a+"/item.htm",s=a.substr(0,a.length-4),i="",l="",_=$("<div/>").html($.post(o)),r="",c=0;c<n.length;c++)c===n.length-1?i+=s+".json":i+=n[c]+"/";return $.post(i,function(e){l=$.parseJSON(e)}),$.each(l.items,function(e,t){$.each(t,function(e,t){$(_).find("[data-key="+e+"]").length>0&&$(_).find("[data-key="+e+"]").prepend(t)}),r+=_}),r}function content_upload(e){return $("body").addClass("_load_"),console.log("content_upload: "+e),console.log(e.indexOf("http")),e.indexOf("http")>=0?(console.log("С сайта"),$.ajax({url:e,data:$(this).serialize(),xhrFields:{withCredentials:!1}}).done(function(t){$(document).find("body").html(t),scroll_to(0,0,0),page_prev(e),$("body").removeClass("_load_")})):(console.log("С приложения"),$.post(e,function(t){template_parse(t,e),scroll_to(0,0,0),page_prev(e),$("body").removeClass("_load_")})),!1}page_url="",site_url="https://alliance.paultik.ru/",pages_history=[],pages_history_length=2,session_key="",csrftoken="",ajax_salt={app:"app"},localStorage.getItem("session_key")&&(session_key=localStorage.getItem("session_key"),ajax_salt.session_key=session_key),user_points=750,localStorage.getItem("user_points")?user_points=localStorage.getItem("user_points"):localStorage.setItem("user_points",user_points),$(function(){$(document).find("main").height($(document).height()-$(document).find("header").height()).css({"padding-top":$(document).find("header").height()+"px"}),$(document).on("click","#main_menu_back",function(){pages_history.length?(content_upload(pages_history[pages_history.length-pages_history_length]),page_prev(),$(document).find("#main_menu_back").removeClass("_active_")):console.log("ne ok 2")}),$(document).on("click",".content_upload",function(){return page_url=$(this).attr("href"),$(this).data("content")?$(this).data("params")?content_upload(page_url,$(this).data("content"),$(this).data("params")):content_upload(page_url,$(this).data("content")):content_upload(page_url),$("#main_menu_show").removeClass("_active_"),$("#main_menu").removeClass("_active_"),$("body").removeClass("_no_active_"),!1}),$(document).on("click","#main_menu_show",function(){return $(this).toggleClass("_active_"),$("#main_menu").toggleClass("_active_"),$("body").toggleClass("_no_active_"),!1}),$(document).on("click","#main_menu li a",function(){return $(this).parents("li").addClass("_active_").siblings().removeClass("_active_"),$("#main_menu_show").removeClass("_active_"),$("#main_menu").removeClass("_active_"),$("body").removeClass("_no_active_"),!1})});